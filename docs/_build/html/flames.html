

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>flames package &mdash; FLAMES Documentation 0.4.4 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=90733dfc"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">flames package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-flames.ase_utils">flames.ase_utils module</a><ul>
<li><a class="reference internal" href="#flames.ase_utils.complete_cell"><code class="docutils literal notranslate"><span class="pre">complete_cell()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.crystalOptimization"><code class="docutils literal notranslate"><span class="pre">crystalOptimization()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.nPT_Berendsen"><code class="docutils literal notranslate"><span class="pre">nPT_Berendsen()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.nPT_NoseHoover"><code class="docutils literal notranslate"><span class="pre">nPT_NoseHoover()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.nVT_Berendsen"><code class="docutils literal notranslate"><span class="pre">nVT_Berendsen()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.pbc2pbc"><code class="docutils literal notranslate"><span class="pre">pbc2pbc()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.rdf_gcmc"><code class="docutils literal notranslate"><span class="pre">rdf_gcmc()</span></code></a></li>
<li><a class="reference internal" href="#flames.ase_utils.unwrap_positions"><code class="docutils literal notranslate"><span class="pre">unwrap_positions()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.base_simulator">flames.base_simulator module</a><ul>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator"><code class="docutils literal notranslate"><span class="pre">BaseSimulator</span></code></a><ul>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.get_framework_mass"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.get_framework_mass()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.get_ideal_supercell"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.get_ideal_supercell()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.npt"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.npt()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.nvt"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.nvt()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.optimize_adsorbate"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.optimize_adsorbate()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.optimize_framework"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.optimize_framework()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.set_adsorbate"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.set_adsorbate()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.set_framework"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.set_framework()</span></code></a></li>
<li><a class="reference internal" href="#flames.base_simulator.BaseSimulator.set_state"><code class="docutils literal notranslate"><span class="pre">BaseSimulator.set_state()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.calculators">flames.calculators module</a><ul>
<li><a class="reference internal" href="#flames.calculators.CustomLennardJones"><code class="docutils literal notranslate"><span class="pre">CustomLennardJones</span></code></a><ul>
<li><a class="reference internal" href="#flames.calculators.CustomLennardJones.calculate"><code class="docutils literal notranslate"><span class="pre">CustomLennardJones.calculate()</span></code></a></li>
<li><a class="reference internal" href="#flames.calculators.CustomLennardJones.default_parameters"><code class="docutils literal notranslate"><span class="pre">CustomLennardJones.default_parameters</span></code></a></li>
<li><a class="reference internal" href="#flames.calculators.CustomLennardJones.implemented_properties"><code class="docutils literal notranslate"><span class="pre">CustomLennardJones.implemented_properties</span></code></a></li>
<li><a class="reference internal" href="#flames.calculators.CustomLennardJones.nolabel"><code class="docutils literal notranslate"><span class="pre">CustomLennardJones.nolabel</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flames.calculators.EwaldSum"><code class="docutils literal notranslate"><span class="pre">EwaldSum</span></code></a><ul>
<li><a class="reference internal" href="#flames.calculators.EwaldSum.calculate"><code class="docutils literal notranslate"><span class="pre">EwaldSum.calculate()</span></code></a></li>
<li><a class="reference internal" href="#flames.calculators.EwaldSum.implemented_properties"><code class="docutils literal notranslate"><span class="pre">EwaldSum.implemented_properties</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.eos">flames.eos module</a><ul>
<li><a class="reference internal" href="#flames.eos.PengRobinsonEOS"><code class="docutils literal notranslate"><span class="pre">PengRobinsonEOS</span></code></a><ul>
<li><a class="reference internal" href="#flames.eos.PengRobinsonEOS.calculate_eos_parameters"><code class="docutils literal notranslate"><span class="pre">PengRobinsonEOS.calculate_eos_parameters()</span></code></a></li>
<li><a class="reference internal" href="#flames.eos.PengRobinsonEOS.get_bulk_phase_density"><code class="docutils literal notranslate"><span class="pre">PengRobinsonEOS.get_bulk_phase_density()</span></code></a></li>
<li><a class="reference internal" href="#flames.eos.PengRobinsonEOS.get_compressibility"><code class="docutils literal notranslate"><span class="pre">PengRobinsonEOS.get_compressibility()</span></code></a></li>
<li><a class="reference internal" href="#flames.eos.PengRobinsonEOS.get_fugacity_coefficient"><code class="docutils literal notranslate"><span class="pre">PengRobinsonEOS.get_fugacity_coefficient()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.exceptions">flames.exceptions module</a><ul>
<li><a class="reference internal" href="#flames.exceptions.InsertionDeletionError"><code class="docutils literal notranslate"><span class="pre">InsertionDeletionError</span></code></a></li>
<li><a class="reference internal" href="#flames.exceptions.MoveKeyError"><code class="docutils literal notranslate"><span class="pre">MoveKeyError</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.gcmc">flames.gcmc module</a><ul>
<li><a class="reference internal" href="#flames.gcmc.GCMC"><code class="docutils literal notranslate"><span class="pre">GCMC</span></code></a><ul>
<li><a class="reference internal" href="#flames.gcmc.GCMC.equilibrate"><code class="docutils literal notranslate"><span class="pre">GCMC.equilibrate()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.get_average_ads_energy"><code class="docutils literal notranslate"><span class="pre">GCMC.get_average_ads_energy()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.load_state"><code class="docutils literal notranslate"><span class="pre">GCMC.load_state()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.restart"><code class="docutils literal notranslate"><span class="pre">GCMC.restart()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.run"><code class="docutils literal notranslate"><span class="pre">GCMC.run()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.save_results"><code class="docutils literal notranslate"><span class="pre">GCMC.save_results()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.step"><code class="docutils literal notranslate"><span class="pre">GCMC.step()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.try_deletion"><code class="docutils literal notranslate"><span class="pre">GCMC.try_deletion()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.try_insertion"><code class="docutils literal notranslate"><span class="pre">GCMC.try_insertion()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.try_rotation"><code class="docutils literal notranslate"><span class="pre">GCMC.try_rotation()</span></code></a></li>
<li><a class="reference internal" href="#flames.gcmc.GCMC.try_translation"><code class="docutils literal notranslate"><span class="pre">GCMC.try_translation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.logger">flames.logger module</a><ul>
<li><a class="reference internal" href="#flames.logger.BaseLogger"><code class="docutils literal notranslate"><span class="pre">BaseLogger</span></code></a><ul>
<li><a class="reference internal" href="#flames.logger.BaseLogger.print_debug_movement"><code class="docutils literal notranslate"><span class="pre">BaseLogger.print_debug_movement()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.BaseLogger.print_header"><code class="docutils literal notranslate"><span class="pre">BaseLogger.print_header()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.BaseLogger.print_restart_info"><code class="docutils literal notranslate"><span class="pre">BaseLogger.print_restart_info()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger"><code class="docutils literal notranslate"><span class="pre">GCMCLogger</span></code></a><ul>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_debug_movement"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_debug_movement()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_iteration_info"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_iteration_info()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_load_state_info"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_load_state_info()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_optimization_start"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_optimization_start()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_run_header"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_run_header()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_step_info"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_step_info()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.GCMCLogger.print_summary"><code class="docutils literal notranslate"><span class="pre">GCMCLogger.print_summary()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#flames.logger.WidomLogger"><code class="docutils literal notranslate"><span class="pre">WidomLogger</span></code></a><ul>
<li><a class="reference internal" href="#flames.logger.WidomLogger.print_iteration_info"><code class="docutils literal notranslate"><span class="pre">WidomLogger.print_iteration_info()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.WidomLogger.print_run_header"><code class="docutils literal notranslate"><span class="pre">WidomLogger.print_run_header()</span></code></a></li>
<li><a class="reference internal" href="#flames.logger.WidomLogger.print_summary"><code class="docutils literal notranslate"><span class="pre">WidomLogger.print_summary()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.operations">flames.operations module</a><ul>
<li><a class="reference internal" href="#flames.operations.check_overlap"><code class="docutils literal notranslate"><span class="pre">check_overlap()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.random_mol_insertion"><code class="docutils literal notranslate"><span class="pre">random_mol_insertion()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.random_position_cell"><code class="docutils literal notranslate"><span class="pre">random_position_cell()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.random_rotation"><code class="docutils literal notranslate"><span class="pre">random_rotation()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.random_rotation_limited"><code class="docutils literal notranslate"><span class="pre">random_rotation_limited()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.random_translation"><code class="docutils literal notranslate"><span class="pre">random_translation()</span></code></a></li>
<li><a class="reference internal" href="#flames.operations.randon_unit_vector_sphere_marsaglia"><code class="docutils literal notranslate"><span class="pre">randon_unit_vector_sphere_marsaglia()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.utilities">flames.utilities module</a><ul>
<li><a class="reference internal" href="#flames.utilities.calculate_unit_cells"><code class="docutils literal notranslate"><span class="pre">calculate_unit_cells()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.check_weights"><code class="docutils literal notranslate"><span class="pre">check_weights()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.enthalpy_of_adsorption"><code class="docutils literal notranslate"><span class="pre">enthalpy_of_adsorption()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.get_density"><code class="docutils literal notranslate"><span class="pre">get_density()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.get_perpendicular_lengths"><code class="docutils literal notranslate"><span class="pre">get_perpendicular_lengths()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.make_cubic"><code class="docutils literal notranslate"><span class="pre">make_cubic()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.random_n_splits"><code class="docutils literal notranslate"><span class="pre">random_n_splits()</span></code></a></li>
<li><a class="reference internal" href="#flames.utilities.read_cif"><code class="docutils literal notranslate"><span class="pre">read_cif()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames.version">flames.version module</a></li>
<li><a class="reference internal" href="#module-flames.widom">flames.widom module</a><ul>
<li><a class="reference internal" href="#flames.widom.Widom"><code class="docutils literal notranslate"><span class="pre">Widom</span></code></a><ul>
<li><a class="reference internal" href="#flames.widom.Widom.restart"><code class="docutils literal notranslate"><span class="pre">Widom.restart()</span></code></a></li>
<li><a class="reference internal" href="#flames.widom.Widom.run"><code class="docutils literal notranslate"><span class="pre">Widom.run()</span></code></a></li>
<li><a class="reference internal" href="#flames.widom.Widom.save_results"><code class="docutils literal notranslate"><span class="pre">Widom.save_results()</span></code></a></li>
<li><a class="reference internal" href="#flames.widom.Widom.step"><code class="docutils literal notranslate"><span class="pre">Widom.step()</span></code></a></li>
<li><a class="reference internal" href="#flames.widom.Widom.try_insertion"><code class="docutils literal notranslate"><span class="pre">Widom.try_insertion()</span></code></a></li>
<li><a class="reference internal" href="#flames.widom.Widom.update_statistics"><code class="docutils literal notranslate"><span class="pre">Widom.update_statistics()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-flames">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FLAMES Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">flames package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/flames.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flames-package">
<h1>flames package<a class="headerlink" href="#flames-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-flames.ase_utils">
<span id="flames-ase-utils-module"></span><h2>flames.ase_utils module<a class="headerlink" href="#module-flames.ase_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.complete_cell">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">complete_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/ase_utils.html#complete_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.complete_cell" title="Link to this definition"></a></dt>
<dd><p>Return 3x3 cell array from cell object.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.crystalOptimization">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">crystalOptimization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calculator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_symmetry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrostatic_strain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant_volume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalar_pressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'opt.traj'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atoms</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/ase_utils.html#crystalOptimization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.crystalOptimization" title="Link to this definition"></a></dt>
<dd><p>Optimize the cell and positions of the atoms with the given calculator.
If fix_symmetry is True, the symmetry of the cell is fixed during the optimization.
If hydrostatic_strain is True, the cell is allowed to change only isotropically.</p>
<p>Helpful conversion table for fmax:</p>
<blockquote>
<div><ul class="simple">
<li><p>0.05 eV/A^3 = 8 GPA = 8000 bar</p></li>
<li><p>0.003 eV/A^3 = 0.48 GPa = 480 bar</p></li>
<li><p>0.0006 eV/A^3 = 0.096 GPa = 96 bar</p></li>
<li><p>0.0003 eV/A^3 = 0.048 GPa = 48 bar</p></li>
<li><p>0.0001 eV/A^3 = 0.02 GPa = 20 bar</p></li>
</ul>
</div></blockquote>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>atoms_in: Atoms</dt><dd><p>The atoms object to optimize.</p>
</dd>
<dt>calculator: Calculator</dt><dd><p>The calculator to use for the optimization.</p>
</dd>
<dt>optimizer: Optimizer</dt><dd><p>The optimizer to use for the optimization. Recommended: lBFGS.</p>
</dd>
<dt>fmax: float</dt><dd><p>The maximum force allowed during the optimization. Default: 0.005 eV/Ang.</p>
</dd>
<dt>opt_cell: bool</dt><dd><p>If True, the cell is optimized during the optimization.</p>
</dd>
<dt>fix_symmetry: bool</dt><dd><p>If True, the symmetry of the cell is fixed during the optimization.</p>
</dd>
<dt>hydrostatic_strain: bool</dt><dd><p>If True, the cell is allowed to change only isotropically.</p>
</dd>
<dt>constant_volume: bool</dt><dd><p>If True, the volume of the cell is fixed during the optimization.</p>
</dd>
<dt>scalar_pressure: float</dt><dd><p>The pressure to use during the optimization. Default is 0.0 GPa.</p>
</dd>
<dt>max_steps: int</dt><dd><p>The maximum number of steps to run the optimization for. Default is 1000.</p>
</dd>
<dt>trajectory: str</dt><dd><p>The name of the trajectory file to write the optimization steps to.</p>
</dd>
<dt>verbose: bool</dt><dd><p>If True, print the optimization steps to the console during the optimization.</p>
</dd>
<dt>symm_tol: float</dt><dd><p>The tolerance to use when checking the symmetry of the cell. Default is 1e-5.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns<a class="headerlink" href="#returns" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>resultsDict: dict</dt><dd><p>A dictionary containing the results of the optimization, including:</p>
</dd>
<dt>atoms: Aoms</dt><dd><p>The optimized atoms object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.nPT_Berendsen">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">nPT_Berendsen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms:</span> <span class="pre">~ase.atoms.Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~ase.calculators.calculator.Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compressibility:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_md_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movie_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taut:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taup:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">500.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">isotropic:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_folder:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file:</span> <span class="pre">~typing.TextIO</span> <span class="pre">=</span> <span class="pre">&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory=None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Atoms</span></span></span><a class="reference internal" href="_modules/flames/ase_utils.html#nPT_Berendsen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.nPT_Berendsen" title="Link to this definition"></a></dt>
<dd><p>Run NPT molecular dynamics simulation using the Berendsen thermostat and barostat.</p>
<p>Warning: The Berendsen method does not change the shape of the simulation cell, i.e.,
it does not change the cell angles. If you want to change the shape of the cell,
use the NPT Nose-Hoover-Parrinello-Rahman method instead.</p>
<section id="id1">
<h3>Parameters<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>atoms<span class="classifier">ase.Atoms</span></dt><dd><p>The atomic structure to simulate.</p>
</dd>
<dt>temperature<span class="classifier">float</span></dt><dd><p>The target temperature in Kelvin.</p>
</dd>
<dt>pressure<span class="classifier">float, optional</span></dt><dd><p>The desired pressure, in bar (1 bar = 1e5 Pa).</p>
</dd>
<dt>compressibility<span class="classifier">float, optional</span></dt><dd><p>The compressibility of the material, in bar-1.</p>
</dd>
<dt>time_step<span class="classifier">float, optional</span></dt><dd><p>The time step for the simulation in femtoseconds (default is 0.5 fs).</p>
</dd>
<dt>num_md_steps<span class="classifier">int, optional</span></dt><dd><p>The total number of MD steps to run (default is 1,000,000).</p>
</dd>
<dt>output_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for logging output (default is 100 steps).</p>
</dd>
<dt>movie_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for saving trajectory frames (default is 1 step).</p>
</dd>
<dt>taut<span class="classifier">float, optional</span></dt><dd><p>The time constant for the Berendsen thermostat in femtoseconds (default is 10.0 fs).</p>
</dd>
<dt>taup<span class="classifier">float, optional</span></dt><dd><p>The time constant for the Berendsen barostat in femtoseconds (default is 500.0 fs).</p>
</dd>
<dt>isotropic<span class="classifier">bool, optional</span></dt><dd><p>If True, the barostat is isotropic, i.e., the unit cell changes equally in all directions
Default is True.</p>
</dd>
<dt>out_folder<span class="classifier">str, optional</span></dt><dd><p>The folder where the output files will be saved (default is the current directory).</p>
</dd>
<dt>out_file<span class="classifier">TextIO, optional</span></dt><dd><p>The output file to write the simulation log to (default is sys.stdout).</p>
</dd>
</dl>
</section>
<section id="id2">
<h3>Returns<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ase.Atoms</dt><dd><p>The final atomic structure after the MD simulation.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.nPT_NoseHoover">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">nPT_NoseHoover</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms:</span> <span class="pre">~ase.atoms.Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~ase.calculators.calculator.Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_md_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movie_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ttime:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">25.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ptime:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">75.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B_guess:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_folder:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file:</span> <span class="pre">~typing.TextIO</span> <span class="pre">=</span> <span class="pre">&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory=None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Atoms</span></span></span><a class="reference internal" href="_modules/flames/ase_utils.html#nPT_NoseHoover"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.nPT_NoseHoover" title="Link to this definition"></a></dt>
<dd><p>Constant pressure/stress and temperature dynamics.</p>
<p>Combined Nose-Hoover and Parrinello-Rahman dynamics, creating an NPT (or N,stress,T) ensemble.</p>
<p>Warning: The Nose-Hoover-Parrinello-Rahman method changes the shape of the simulation cell, i.e.,
it changes the cell angles. If you do not want to change the shape of the cell, use the NPT-Barendsen instead.</p>
<section id="id3">
<h3>Parameters<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>atoms<span class="classifier">ase.Atoms</span></dt><dd><p>The atomic structure to simulate.</p>
</dd>
<dt>temperature<span class="classifier">float</span></dt><dd><p>The target temperature in Kelvin.</p>
</dd>
<dt>pressure<span class="classifier">float, optional</span></dt><dd><p>The desired pressure, in bar (1 bar = 1e5 Pa).</p>
</dd>
<dt>time_step<span class="classifier">float, optional</span></dt><dd><p>The time step for the simulation in femtoseconds (default is 0.5 fs).</p>
</dd>
<dt>num_md_steps<span class="classifier">int, optional</span></dt><dd><p>The total number of MD steps to run (default is 1,000,000).</p>
</dd>
<dt>output_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for logging output (default is 100 steps).</p>
</dd>
<dt>movie_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for saving trajectory frames (default is 1 step).</p>
</dd>
<dt>ttime<span class="classifier">float, optional</span></dt><dd><p>Characteristic timescale of the thermostat, in femtoseconds. Set to None to disable the thermostat.
Default is 25.0 fs.</p>
</dd>
<dt>ptime<span class="classifier">float, optional</span></dt><dd><p>A constant in the barostat differential equation in femtoseconds. Set to None to disable the barostat.
Default is 500.0 fs.</p>
</dd>
<dt>out_folder<span class="classifier">str, optional</span></dt><dd><p>The folder where the output files will be saved (default is the current directory).</p>
</dd>
<dt>out_file<span class="classifier">TextIO, optional</span></dt><dd><p>The output file to write the simulation log to (default is sys.stdout).</p>
</dd>
</dl>
</section>
<section id="id4">
<h3>Returns<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ase.Atoms</dt><dd><p>The final atomic structure after the MD simulation.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.nVT_Berendsen">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">nVT_Berendsen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms:</span> <span class="pre">~ase.atoms.Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model:</span> <span class="pre">~ase.calculators.calculator.Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature:</span> <span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_md_steps:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">movie_interval:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taut:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_folder:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file:</span> <span class="pre">~typing.TextIO</span> <span class="pre">=</span> <span class="pre">&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trajectory=None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Atoms</span></span></span><a class="reference internal" href="_modules/flames/ase_utils.html#nVT_Berendsen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.nVT_Berendsen" title="Link to this definition"></a></dt>
<dd><p>Run NVT molecular dynamics simulation using the Berendsen thermostat.</p>
<p>The Berendsen thermostat is a deterministic type of velocity scaling method that
adjusts the velocities of the atoms to maintain a target temperature of the entire system.
It is not a true canonical ensemble method, but it is often used for its simplicity and speed.</p>
<section id="id5">
<h3>Parameters<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>atoms<span class="classifier">ase.Atoms</span></dt><dd><p>The atomic structure to simulate.</p>
</dd>
<dt>temperature<span class="classifier">float</span></dt><dd><p>The target temperature in Kelvin.</p>
</dd>
<dt>time_step<span class="classifier">float, optional</span></dt><dd><p>The time step for the simulation in femtoseconds (default is 0.5 fs).</p>
</dd>
<dt>num_md_steps<span class="classifier">int, optional</span></dt><dd><p>The total number of MD steps to run (default is 1,000,000).</p>
</dd>
<dt>output_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for logging output (default is 100 steps).</p>
</dd>
<dt>movie_interval<span class="classifier">int, optional</span></dt><dd><p>The interval for saving trajectory frames (default is 1 step).</p>
</dd>
<dt>taut<span class="classifier">float, optional</span></dt><dd><p>The time constant for the Berendsen thermostat in femtoseconds (default is 1.0 fs).</p>
</dd>
<dt>out_folder<span class="classifier">str, optional</span></dt><dd><p>The folder where the output files will be saved (default is the current directory).</p>
</dd>
<dt>out_file<span class="classifier">TextIO, optional</span></dt><dd><p>The output file to write the simulation log to (default is sys.stdout).</p>
</dd>
</dl>
</section>
<section id="id6">
<h3>Returns<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ase.Atoms</dt><dd><p>The final atomic structure after the MD simulation.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.pbc2pbc">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">pbc2pbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pbc</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/ase_utils.html#pbc2pbc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.pbc2pbc" title="Link to this definition"></a></dt>
<dd><p>Helper function for dealing with pbc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.rdf_gcmc">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">rdf_gcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Atoms</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">binwidth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_progress</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/ase_utils.html#rdf_gcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.rdf_gcmc" title="Link to this definition"></a></dt>
<dd><p>Calculate radial distribution function for GCMC trajectories.</p>
<p>This version is modified to handle trajectories where the
number of atoms changes per frame (e.g., GCMC).</p>
<section id="id7">
<h3>Parameters<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>images<span class="classifier">list of Atoms or Trajectory</span></dt><dd><p>ASE Atoms object(s).</p>
</dd>
<dt>atom_1, atom_2<span class="classifier">str</span></dt><dd><p>Atoms to use for the RDF calculation. MUST be element symbols
(e.g., ‘O’) for GCMC. Integer indices are NOT supported as
they are not persistent in GCMC.</p>
</dd>
<dt>rmax<span class="classifier">float</span></dt><dd><p>Maximum radius (in Angstrom) for the RDF calculation.
This is required for consistent binning.</p>
</dd>
<dt>binwidth<span class="classifier">float</span></dt><dd><p>The distance increments (in Angstrom).</p>
</dd>
<dt>exclude_idx<span class="classifier">list of int</span></dt><dd><p>Atomic indices to be ignored. Note: This assumes these
indices are ‘static’ (e.g., a fixed slab) and exist
in all frames. Use with caution in GCMC.</p>
</dd>
<dt>surface<span class="classifier">bool</span></dt><dd><p>If True, returns the g(z) instead of the g(r).
Normalization is 1D (per area) instead of 3D (per volume).</p>
</dd>
<dt>show_progress: bool</dt><dd><p>Show progress bar using tqdm library</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Returns<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>g_r: ndarray</dt><dd><p>2D (r, g_r) numpy array.</p>
</dd>
</dl>
</section>
<section id="raises">
<h3>Raises<a class="headerlink" href="#raises" title="Link to this heading"></a></h3>
<p>ValueError</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.ase_utils.unwrap_positions">
<span class="sig-prename descclassname"><span class="pre">flames.ase_utils.</span></span><span class="sig-name descname"><span class="pre">unwrap_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pbc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_atom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/ase_utils.html#unwrap_positions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.ase_utils.unwrap_positions" title="Link to this definition"></a></dt>
<dd><p>Unwrap positions relative to a reference atom.</p>
<p>This function translates atoms by integer multiples of the
lattice vectors so that they form a connected set,
minimizing the distance to a reference atom. This is the
reverse of wrap_positions.</p>
<p>Parameters:</p>
<dl class="simple">
<dt>positions: float ndarray of shape (n, 3)</dt><dd><p>Positions of the atoms.</p>
</dd>
<dt>cell: float ndarray of shape (3, 3)</dt><dd><p>Unit cell vectors.</p>
</dd>
<dt>pbc: one or 3 bool</dt><dd><p>For each axis in the unit cell, decides whether
unwrapping is applied.</p>
</dd>
<dt>ref_atom: int</dt><dd><p>The index of the atom to use as the reference point (default 0).
All other atoms will be unwrapped to be as close as
possible to this atom.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-flames.base_simulator">
<span id="flames-base-simulator-module"></span><h2>flames.base_simulator module<a class="headerlink" href="#module-flames.base_simulator" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.base_simulator.</span></span><span class="sig-name descname"><span class="pre">BaseSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adsorbate_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_radii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_deltaE</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.555</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_rejected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_to_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fugacity_coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class handles all base parameters for the simulations.
Separates the basic logic used in the simulations from the specific implementation details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.get_framework_mass">
<span class="sig-name descname"><span class="pre">get_framework_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.get_framework_mass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.get_framework_mass" title="Link to this definition"></a></dt>
<dd><p>Calculate the mass of the framework in kg.</p>
<section id="id9">
<h3>Returns<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>float</dt><dd><p>The mass of the framework in kg.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.get_ideal_supercell">
<span class="sig-name descname"><span class="pre">get_ideal_supercell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.get_ideal_supercell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.get_ideal_supercell" title="Link to this definition"></a></dt>
<dd><p>Get the ideal supercell dimensions based on the cutoff radius.</p>
<section id="id10">
<h3>Returns<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>list[int]</dt><dd><p>A list of three integers representing the number of unit cells in each dimension.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.npt">
<span class="sig-name descname"><span class="pre">npt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'iso_shape'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.npt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.npt" title="Link to this definition"></a></dt>
<dd><p>Run a NPT simulation using the Berendsen thermostat and barostat.</p>
<section id="id11">
<h3>Parameters<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nsteps<span class="classifier">int</span></dt><dd><p>Number of steps to run the NPT simulation.</p>
</dd>
<dt>time_step<span class="classifier">float, optional</span></dt><dd><p>Time step for the NPT simulation (default is 0.5 fs).</p>
</dd>
<dt>mode<span class="classifier">str, optional</span></dt><dd><p>The mode of the NPT simulation (default is “iso_shape”).
Can be one of “iso_shape”, “aniso_shape”, or “aniso_flex”.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.nvt">
<span class="sig-name descname"><span class="pre">nvt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsteps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.nvt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.nvt" title="Link to this definition"></a></dt>
<dd><p>Run a NVT simulation using the Berendsen thermostat.</p>
<section id="id12">
<h3>Parameters<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>nsteps<span class="classifier">int</span></dt><dd><p>Number of steps to run the NVT simulation.</p>
</dd>
<dt>time_step<span class="classifier">float, optional</span></dt><dd><p>Time step for the NVT simulation (default is 0.5 fs).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.optimize_adsorbate">
<span class="sig-name descname"><span class="pre">optimize_adsorbate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.optimize_adsorbate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.optimize_adsorbate" title="Link to this definition"></a></dt>
<dd><p>Optimize the adsorbate structure using the provided calculator.</p>
<section id="id13">
<h3>Parameters<a class="headerlink" href="#id13" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>max_steps<span class="classifier">int, optional</span></dt><dd><p>Maximum number of optimization steps (default is 1000).</p>
</dd>
<dt>symm_tol<span class="classifier">float, optional</span></dt><dd><p>Tolerance for symmetry (default is 1e-3).</p>
</dd>
<dt>max_force<span class="classifier">float, optional</span></dt><dd><p>Maximum force tolerance for convergence (default is 0.05 eV/Å).</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Returns<a class="headerlink" href="#id14" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ase.Atoms</dt><dd><p>The optimized adsorbate structure.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.optimize_framework">
<span class="sig-name descname"><span class="pre">optimize_framework</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_symmetry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hydrostatic_strain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_force</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.optimize_framework"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.optimize_framework" title="Link to this definition"></a></dt>
<dd><p>Optimize the framework structure using the provided calculator.</p>
<section id="id15">
<h3>Parameters<a class="headerlink" href="#id15" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>max_steps<span class="classifier">int, optional</span></dt><dd><p>Maximum number of optimization steps (default is 1000).</p>
</dd>
<dt>tol<span class="classifier">float, optional</span></dt><dd><p>Tolerance for convergence (default is 1e-5).</p>
</dd>
</dl>
</section>
<section id="id16">
<h3>Returns<a class="headerlink" href="#id16" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>ase.Atoms</dt><dd><p>The optimized framework structure.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.set_adsorbate">
<span class="sig-name descname"><span class="pre">set_adsorbate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adsorbate_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.set_adsorbate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.set_adsorbate" title="Link to this definition"></a></dt>
<dd><p>Set the adsorbate structure for the simulation.</p>
<section id="id17">
<h3>Parameters<a class="headerlink" href="#id17" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>adsorbate_atoms<span class="classifier">ase.Atoms</span></dt><dd><p>The new adsorbate structure as an ASE Atoms object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.set_framework">
<span class="sig-name descname"><span class="pre">set_framework</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">framework_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.set_framework"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.set_framework" title="Link to this definition"></a></dt>
<dd><p>Set the framework structure for the simulation.</p>
<section id="id18">
<h3>Parameters<a class="headerlink" href="#id18" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>framework_atoms<span class="classifier">ase.Atoms</span></dt><dd><p>The new framework structure as an ASE Atoms object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.base_simulator.BaseSimulator.set_state">
<span class="sig-name descname"><span class="pre">set_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/base_simulator.html#BaseSimulator.set_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.base_simulator.BaseSimulator.set_state" title="Link to this definition"></a></dt>
<dd><p>Set the current state of the simulation.</p>
<section id="id19">
<h3>Parameters<a class="headerlink" href="#id19" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>state<span class="classifier">ase.Atoms</span></dt><dd><p>The current state of the simulation as an ASE Atoms object.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames.calculators">
<span id="flames-calculators-module"></span><h2>flames.calculators module<a class="headerlink" href="#module-flames.calculators" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.calculators.CustomLennardJones">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.calculators.</span></span><span class="sig-name descname"><span class="pre">CustomLennardJones</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lj_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/calculators.html#CustomLennardJones"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.calculators.CustomLennardJones" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Calculator</span></code></p>
<p>Custom Lennard Jones potential calculator based on the ASE calculator interface.
This method is intended to be as close as possible to RASPA2 implementation.</p>
<p>The fundamental definition of this potential is a pairwise energy:</p>
<p><code class="docutils literal notranslate"><span class="pre">u_ij</span> <span class="pre">=</span> <span class="pre">4</span> <span class="pre">epsilon</span> <span class="pre">(</span> <span class="pre">sigma^12/r_ij^12</span> <span class="pre">-</span> <span class="pre">sigma^6/r_ij^6</span> <span class="pre">)</span></code></p>
<p>For convenience, we’ll use d_ij to refer to “distance vector” and
<code class="docutils literal notranslate"><span class="pre">r_ij</span></code> to refer to “scalar distance”. So, with position vectors <cite>r_i</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">r_ij</span> <span class="pre">=</span> <span class="pre">|</span> <span class="pre">r_j</span> <span class="pre">-</span> <span class="pre">r_i</span> <span class="pre">|</span> <span class="pre">=</span> <span class="pre">|</span> <span class="pre">d_ij</span> <span class="pre">|</span></code></p>
<p>Therefore:</p>
<p><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">r_ij</span> <span class="pre">/</span> <span class="pre">d</span> <span class="pre">d_ij</span> <span class="pre">=</span> <span class="pre">+</span> <span class="pre">d_ij</span> <span class="pre">/</span> <span class="pre">r_ij</span></code>
<code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">r_ij</span> <span class="pre">/</span> <span class="pre">d</span> <span class="pre">d_i</span>&#160; <span class="pre">=</span> <span class="pre">-</span> <span class="pre">d_ij</span> <span class="pre">/</span> <span class="pre">r_ij</span></code></p>
<p>The derivative of u_ij is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">d</span> <span class="n">u_ij</span> <span class="o">/</span> <span class="n">d</span> <span class="n">r_ij</span>
<span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">24</span> <span class="n">epsilon</span> <span class="o">/</span> <span class="n">r_ij</span><span class="p">)</span> <span class="p">(</span> <span class="mi">2</span> <span class="n">sigma</span><span class="o">^</span><span class="mi">12</span><span class="o">/</span><span class="n">r_ij</span><span class="o">^</span><span class="mi">12</span> <span class="o">-</span> <span class="n">sigma</span><span class="o">^</span><span class="mi">6</span><span class="o">/</span><span class="n">r_ij</span><span class="o">^</span><span class="mi">6</span> <span class="p">)</span>
</pre></div>
</div>
<p>We can define a “pairwise force”</p>
<p><code class="docutils literal notranslate"><span class="pre">f_ij</span> <span class="pre">=</span> <span class="pre">d</span> <span class="pre">u_ij</span> <span class="pre">/</span> <span class="pre">d</span> <span class="pre">d_ij</span> <span class="pre">=</span> <span class="pre">d</span> <span class="pre">u_ij</span> <span class="pre">/</span> <span class="pre">d</span> <span class="pre">r_ij</span> <span class="pre">*</span> <span class="pre">d_ij</span> <span class="pre">/</span> <span class="pre">r_ij</span></code></p>
<p>The terms in front of d_ij are combined into a “general derivative”.</p>
<p><code class="docutils literal notranslate"><span class="pre">du_ij</span> <span class="pre">=</span> <span class="pre">(d</span> <span class="pre">u_ij</span> <span class="pre">/</span> <span class="pre">d</span> <span class="pre">d_ij)</span> <span class="pre">/</span> <span class="pre">r_ij</span></code></p>
<p>We do this for convenience: <cite>du_ij</cite> is purely scalar The pairwise force is:</p>
<p><code class="docutils literal notranslate"><span class="pre">f_ij</span> <span class="pre">=</span> <span class="pre">du_ij</span> <span class="pre">*</span> <span class="pre">d_ij</span></code></p>
<p>The total force on an atom is:</p>
<p><code class="docutils literal notranslate"><span class="pre">f_i</span> <span class="pre">=</span> <span class="pre">sum_(j</span> <span class="pre">!=</span> <span class="pre">i)</span> <span class="pre">f_ij</span></code></p>
<p>There is some freedom of choice in assigning atomic energies, i.e.
choosing a way to partition the total energy into atomic contributions.</p>
<p>We choose a symmetric approach (<cite>bothways=True</cite> in the neighbor list):</p>
<p><code class="docutils literal notranslate"><span class="pre">u_i</span> <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">sum_(j</span> <span class="pre">!=</span> <span class="pre">i)</span> <span class="pre">u_ij</span></code></p>
<p>The total energy of a system of atoms is then:</p>
<p><code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">sum_i</span> <span class="pre">u_i</span> <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">sum_(i,</span> <span class="pre">j</span> <span class="pre">!=</span> <span class="pre">i)</span> <span class="pre">u_ij</span></code></p>
<p>Differentiating <cite>u</cite> with respect to <cite>r_i</cite> yields the force,
independent of the choice of partitioning.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f_i</span> <span class="o">=</span> <span class="o">-</span> <span class="n">d</span> <span class="n">u</span> <span class="o">/</span> <span class="n">d</span> <span class="n">r_i</span> <span class="o">=</span> <span class="o">-</span> <span class="n">sum_ij</span> <span class="n">d</span> <span class="n">u_ij</span> <span class="o">/</span> <span class="n">d</span> <span class="n">r_i</span>
    <span class="o">=</span> <span class="o">-</span> <span class="n">sum_ij</span> <span class="n">d</span> <span class="n">u_ij</span> <span class="o">/</span> <span class="n">d</span> <span class="n">r_ij</span> <span class="o">*</span> <span class="n">d</span> <span class="n">r_ij</span> <span class="o">/</span> <span class="n">d</span> <span class="n">r_i</span>
    <span class="o">=</span> <span class="n">sum_ij</span> <span class="n">du_ij</span> <span class="n">d_ij</span> <span class="o">=</span> <span class="n">sum_ij</span> <span class="n">f_ij</span>
</pre></div>
</div>
<p>This justifies calling <cite>f_ij</cite> pairwise forces.</p>
<p>The stress can be written as ( <cite>(x)</cite> denoting outer product):</p>
<p><code class="docutils literal notranslate"><span class="pre">sigma</span> <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">sum_(i,</span> <span class="pre">j</span> <span class="pre">!=</span> <span class="pre">i)</span> <span class="pre">f_ij</span> <span class="pre">(x)</span> <span class="pre">d_ij</span> <span class="pre">=</span> <span class="pre">sum_i</span> <span class="pre">sigma_i</span> <span class="pre">,</span></code>
with atomic contributions</p>
<p><code class="docutils literal notranslate"><span class="pre">sigma_i</span>&#160; <span class="pre">=</span> <span class="pre">1/2</span> <span class="pre">sum_(j</span> <span class="pre">!=</span> <span class="pre">i)</span> <span class="pre">f_ij</span> <span class="pre">(x)</span> <span class="pre">d_ij</span></code></p>
<p>Another consideration is the cutoff. We have to ensure that the potential
goes to zero smoothly as an atom moves across the cutoff threshold,
otherwise the potential is not continuous. In cases where the cutoff is
so large that u_ij is very small at the cutoff this is automatically
ensured, but in general, <cite>u_ij(rc) != 0</cite>.</p>
<p>This implementation offers two ways to deal with this:</p>
<p>Either, we shift the pairwise energy</p>
<p><code class="docutils literal notranslate"><span class="pre">u'_ij</span> <span class="pre">=</span> <span class="pre">u_ij</span> <span class="pre">-</span> <span class="pre">u_ij(rc)</span></code></p>
<p>which ensures that it is precisely zero at the cutoff. However, this means
that the energy effectively depends on the cutoff, which might lead to
unexpected results! If this option is chosen, the forces discontinuously
jump to zero at the cutoff.</p>
<p>An alternative is to modify the pairwise potential by multiplying
it with a cutoff function that goes from 1 to 0 between an onset radius
ro and the cutoff rc. If the function is chosen suitably, it can also
smoothly push the forces down to zero, ensuring continuous forces as well.
In order for this to work well, the onset radius has to be set suitably,
typically around 2*sigma.</p>
<p>In this case, we introduce a modified pairwise potential:</p>
<p><code class="docutils literal notranslate"><span class="pre">u'_ij</span> <span class="pre">=</span> <span class="pre">fc</span> <span class="pre">*</span> <span class="pre">u_ij</span></code></p>
<p>The pairwise forces have to be modified accordingly:</p>
<p><code class="docutils literal notranslate"><span class="pre">f'_ij</span> <span class="pre">=</span> <span class="pre">fc</span> <span class="pre">*</span> <span class="pre">f_ij</span> <span class="pre">+</span> <span class="pre">fc'</span> <span class="pre">*</span> <span class="pre">u_ij</span></code></p>
<p>Where <cite>fc’ = d fc / d d_ij</cite>.</p>
<p>This approach is taken from Jax-MD (<a class="reference external" href="https://github.com/google/jax-md">https://github.com/google/jax-md</a>),
which in turn is inspired by HOOMD Blue
(<a class="reference external" href="https://glotzerlab.engin.umich.edu/hoomd-blue/">https://glotzerlab.engin.umich.edu/hoomd-blue/</a>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.calculators.CustomLennardJones.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_changes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['positions',</span> <span class="pre">'numbers',</span> <span class="pre">'cell',</span> <span class="pre">'pbc',</span> <span class="pre">'initial_charges',</span> <span class="pre">'initial_magmoms']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/calculators.html#CustomLennardJones.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.calculators.CustomLennardJones.calculate" title="Link to this definition"></a></dt>
<dd><p>Do the calculation.</p>
<dl class="simple">
<dt>properties: list of str</dt><dd><p>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</p>
</dd>
<dt>system_changes: list of str</dt><dd><p>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</p>
</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute and create any missing
directories.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flames.calculators.CustomLennardJones.default_parameters">
<span class="sig-name descname"><span class="pre">default_parameters</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'epsilon':</span> <span class="pre">1.0,</span> <span class="pre">'rc':</span> <span class="pre">None,</span> <span class="pre">'ro':</span> <span class="pre">None,</span> <span class="pre">'sigma':</span> <span class="pre">1.0,</span> <span class="pre">'smooth':</span> <span class="pre">False}</span></em><a class="headerlink" href="#flames.calculators.CustomLennardJones.default_parameters" title="Link to this definition"></a></dt>
<dd><p>Default parameters</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flames.calculators.CustomLennardJones.implemented_properties">
<span class="sig-name descname"><span class="pre">implemented_properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['energy',</span> <span class="pre">'energies']</span></em><a class="headerlink" href="#flames.calculators.CustomLennardJones.implemented_properties" title="Link to this definition"></a></dt>
<dd><p>Properties calculator can handle (energy, forces, …)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flames.calculators.CustomLennardJones.nolabel">
<span class="sig-name descname"><span class="pre">nolabel</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#flames.calculators.CustomLennardJones.nolabel" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flames.calculators.EwaldSum">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.calculators.</span></span><span class="sig-name descname"><span class="pre">EwaldSum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R_cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G_cutoff_N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/calculators.html#EwaldSum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.calculators.EwaldSum" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Calculator</span></code></p>
<p>A generalized, vectorized Ewald summation calculator for ASE.</p>
<p>This class calculates the electrostatic energy of a periodic structure
using the Ewald summation method. It is generalized for any unit cell
and uses numpy vectorization for speed.</p>
<p>It calculates per-atom energies, and the total energy is the sum of these.</p>
<p>The energy is E = E_real + E_reciprocal + E_self.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.calculators.EwaldSum.calculate">
<span class="sig-name descname"><span class="pre">calculate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">properties</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['energy',</span> <span class="pre">'energies']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system_changes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['positions',</span> <span class="pre">'numbers',</span> <span class="pre">'cell',</span> <span class="pre">'pbc',</span> <span class="pre">'initial_charges',</span> <span class="pre">'initial_magmoms']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/calculators.html#EwaldSum.calculate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.calculators.EwaldSum.calculate" title="Link to this definition"></a></dt>
<dd><p>Do the calculation.</p>
<dl class="simple">
<dt>properties: list of str</dt><dd><p>List of what needs to be calculated.  Can be any combination
of ‘energy’, ‘forces’, ‘stress’, ‘dipole’, ‘charges’, ‘magmom’
and ‘magmoms’.</p>
</dd>
<dt>system_changes: list of str</dt><dd><p>List of what has changed since last calculation.  Can be
any combination of these six: ‘positions’, ‘numbers’, ‘cell’,
‘pbc’, ‘initial_charges’ and ‘initial_magmoms’.</p>
</dd>
</dl>
<p>Subclasses need to implement this, but can ignore properties
and system_changes if they want.  Calculated properties should
be inserted into results dictionary like shown in this dummy
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;energy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;forces&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">),</span> <span class="mi">3</span><span class="p">)),</span>
                <span class="s1">&#39;stress&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                <span class="s1">&#39;dipole&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
                <span class="s1">&#39;charges&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)),</span>
                <span class="s1">&#39;magmom&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
                <span class="s1">&#39;magmoms&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">))}</span>
</pre></div>
</div>
<p>The subclass implementation should first call this
implementation to set the atoms attribute and create any missing
directories.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="flames.calculators.EwaldSum.implemented_properties">
<span class="sig-name descname"><span class="pre">implemented_properties</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['energy',</span> <span class="pre">'free_energy',</span> <span class="pre">'energies']</span></em><a class="headerlink" href="#flames.calculators.EwaldSum.implemented_properties" title="Link to this definition"></a></dt>
<dd><p>Properties calculator can handle (energy, forces, …)</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames.eos">
<span id="flames-eos-module"></span><h2>flames.eos module<a class="headerlink" href="#module-flames.eos" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.eos.PengRobinsonEOS">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.eos.</span></span><span class="sig-name descname"><span class="pre">PengRobinsonEOS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criticalTemperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criticalPressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acentricFactor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molarMass</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/eos.html#PengRobinsonEOS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.eos.PengRobinsonEOS" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.eos.PengRobinsonEOS.calculate_eos_parameters">
<span class="sig-name descname"><span class="pre">calculate_eos_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/eos.html#PengRobinsonEOS.calculate_eos_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.eos.PengRobinsonEOS.calculate_eos_parameters" title="Link to this definition"></a></dt>
<dd><p>Calculate the parameters A and B for the Peng-Robinson EOS.</p>
<section id="id20">
<h3>Returns:<a class="headerlink" href="#id20" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>A: float</dt><dd><p>Parameter A</p>
</dd>
<dt>B: float</dt><dd><p>Parameter B</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.eos.PengRobinsonEOS.get_bulk_phase_density">
<span class="sig-name descname"><span class="pre">get_bulk_phase_density</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/eos.html#PengRobinsonEOS.get_bulk_phase_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.eos.PengRobinsonEOS.get_bulk_phase_density" title="Link to this definition"></a></dt>
<dd><p>Calculate the bulk phase density using the Peng-Robinson EOS.</p>
<blockquote>
<div><p>rho = MM / Vm</p>
</div></blockquote>
<p>where:
rho is the density in kg/m^3,
MM is the molar mass in g/mol,
Vm is the molar volume in m^3/mol.</p>
<section id="id21">
<h3>Returns:<a class="headerlink" href="#id21" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>density: float</dt><dd><p>Bulk phase density in kg/m^3</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.eos.PengRobinsonEOS.get_compressibility">
<span class="sig-name descname"><span class="pre">get_compressibility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/eos.html#PengRobinsonEOS.get_compressibility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.eos.PengRobinsonEOS.get_compressibility" title="Link to this definition"></a></dt>
<dd><p>Calculate the compressibility factor Z using the Peng-Robinson EOS.</p>
<p>The compressibility factor Z is calculated by solving the cubic equation derived from the Peng-Robinson EOS:</p>
<p>Z^3 - (1 - B) * Z^2 + (A - 2 * B - 3 * B^2) * Z - (A * B - B^2 - B^3) = 0</p>
<section id="id22">
<h3>Returns:<a class="headerlink" href="#id22" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Z: float</dt><dd><p>Compressibility factor Z</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.eos.PengRobinsonEOS.get_fugacity_coefficient">
<span class="sig-name descname"><span class="pre">get_fugacity_coefficient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/eos.html#PengRobinsonEOS.get_fugacity_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.eos.PengRobinsonEOS.get_fugacity_coefficient" title="Link to this definition"></a></dt>
<dd><p>Calculate the fugacity coefficient using the Peng-Robinson EOS.</p>
<p>The fugacity coefficient is calculated using the compressibility factor Z and the parameters A and B:</p>
<p>ln(phi) = (Z - 1) - log(Z - B) - A / (2 * sqrt(2) * B) * log((Z + (1 + sqrt(2)) * B) / (Z + (1 - sqrt(2)) * B))</p>
<p>where:
phi is the fugacity coefficient,
Z is the compressibility factor,
A and B are parameters calculated from the Peng-Robinson EOS.</p>
<section id="id23">
<h3>Returns:<a class="headerlink" href="#id23" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>phi: float</dt><dd><p>Fugacity coefficient phi</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames.exceptions">
<span id="flames-exceptions-module"></span><h2>flames.exceptions module<a class="headerlink" href="#module-flames.exceptions" title="Link to this heading"></a></h2>
<p>This file implements custom exceptions for the flames package.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="flames.exceptions.InsertionDeletionError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.exceptions.</span></span><span class="sig-name descname"><span class="pre">InsertionDeletionError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">insertion_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deletion_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/exceptions.html#InsertionDeletionError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.exceptions.InsertionDeletionError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised when insertion and deletion weights are not equal.</p>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>insertion_weight<span class="classifier">float</span></dt><dd><p>The weight for insertion moves.</p>
</dd>
<dt>deletion_weight<span class="classifier">float</span></dt><dd><p>The weight for deletion moves.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="flames.exceptions.MoveKeyError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.exceptions.</span></span><span class="sig-name descname"><span class="pre">MoveKeyError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moves</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/exceptions.html#MoveKeyError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.exceptions.MoveKeyError" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception raised for errors in the move key.</p>
<section id="id24">
<h3>Attributes<a class="headerlink" href="#id24" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>move<span class="classifier">str</span></dt><dd><p>The move keys that caused the error.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-flames.gcmc">
<span id="flames-gcmc-module"></span><h2>flames.gcmc module<a class="headerlink" href="#module-flames.gcmc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.gcmc.GCMC">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.gcmc.</span></span><span class="sig-name descname"><span class="pre">GCMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adsorbate_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_radii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_overlap_tries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_translation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_rotation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2617993877991494</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_deltaE</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.555</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_rejected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_to_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fugacity_coeff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criticalTemperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criticalPressure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acentricFactor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">LLM</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">move_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'deletion':</span> <span class="pre">0.25,</span> <span class="pre">'insertion':</span> <span class="pre">0.25,</span> <span class="pre">'rotation':</span> <span class="pre">0.25,</span> <span class="pre">'translation':</span> <span class="pre">0.25}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#flames.base_simulator.BaseSimulator" title="flames.base_simulator.BaseSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSimulator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.equilibrate">
<span class="sig-name descname"><span class="pre">equilibrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_ADF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uSD'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.equilibrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.equilibrate" title="Link to this definition"></a></dt>
<dd><p>Use pyMSER to get the equilibrated statistics of the simulation.</p>
<section id="id25">
<h3>Parameters<a class="headerlink" href="#id25" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>LLM<span class="classifier">bool</span></dt><dd><p>If True, use the Leftmost-Local Minima (LLM) method to determine the equilibration time.
This is only recommended for high-throughput simulations, and sometimes can underestimate
the true equilibration point.
Default is True.</p>
</dd>
<dt>batch_size<span class="classifier">int</span></dt><dd><p>Batch size to use for speedup the equilibration process. Default is 100.</p>
</dd>
<dt>run_ADF<span class="classifier">bool</span></dt><dd><p>If True, run the Augmented Dickey-Fuller (ADF) test to confirm for stationarity.
Default is False.</p>
</dd>
<dt>uncertainty<span class="classifier">str</span></dt><dd><p>The type of uncertainty to use for the equilibration process. Default is “uSD”.
Options are:
- “uSD”: uncorrelated Standard Deviation
- “uSE”: uncorrelated Standard Error
- “SD”: Standard Deviation
- “SE”: Standard Error</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.get_average_ads_energy">
<span class="sig-name descname"><span class="pre">get_average_ads_energy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.get_average_ads_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.get_average_ads_energy" title="Link to this definition"></a></dt>
<dd><p>Compute the average adsorption energy per adsorbed molecule.</p>
<dl class="simple">
<dt>The adsorption energy is calculated as:</dt><dd><p>E_ads_avg = [E_total - (N_ads * E_adsorbate) - E_framework] / N_ads</p>
</dd>
<dt>where:</dt><dd><ul class="simple">
<li><p>E_total: current total energy of the system (simulation)</p></li>
<li><p>N_ads: number of adsorbed molecules</p></li>
<li><p>E_adsorbate: energy of an isolated adsorbate molecule</p></li>
<li><p>E_framework: energy of the empty framework</p></li>
</ul>
</dd>
</dl>
<p>The result is converted from simulation units to kJ/mol per adsorbate.</p>
<section id="id26">
<h3>Returns<a class="headerlink" href="#id26" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>float</dt><dd><p>The average adsorption energy per molecule in kJ/mol.
Returns 0.0 if no molecules are adsorbed (N_ads == 0).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.load_state">
<span class="sig-name descname"><span class="pre">load_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.load_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.load_state" title="Link to this definition"></a></dt>
<dd><p>Load the state of the simulation from a file.</p>
<section id="id27">
<h3>Parameters<a class="headerlink" href="#id27" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>state_file<span class="classifier">str</span></dt><dd><p>Path to the file containing the saved state of the simulation.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.restart">
<span class="sig-name descname"><span class="pre">restart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.restart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.restart" title="Link to this definition"></a></dt>
<dd><p>Restart the simulation from the last state.</p>
<p>This method loads the last saved state from the trajectory file and restores the simulation to that state.
It also loads the uptake, total energy, and total adsorbates lists from the saved files if they exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.run" title="Link to this definition"></a></dt>
<dd><p>Run the Grand Canonical Monte Carlo simulation for N iterations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'GCMC_Results.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_ADF</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncertainty</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'uSD'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.save_results" title="Link to this definition"></a></dt>
<dd><p>Save a json file with the main results of the simulation.</p>
<section id="id28">
<h3>Parameters<a class="headerlink" href="#id28" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file_name<span class="classifier">str</span></dt><dd><p>Name of the output file. Default is ‘GCMC_Results.json’.</p>
</dd>
<dt>LLM<span class="classifier">bool</span></dt><dd><p>If True, use the Leftmost-Local Minima (LLM) method to determine the equilibration time.
This is only recommended for high-throughput simulations, and sometimes can underestimate
the true equilibration point.
Default is True.</p>
</dd>
<dt>batch_size<span class="classifier">int</span></dt><dd><p>Batch size to use for speedup the equilibration process.
Default is False, which means 2% of the total number of steps.</p>
</dd>
<dt>run_ADF<span class="classifier">bool</span></dt><dd><p>If True, run the Augmented Dickey-Fuller (ADF) test to confirm for stationarity.
Default is False.</p>
</dd>
<dt>uncertainty<span class="classifier">str</span></dt><dd><p>The type of uncertainty to use for the equilibration process. Default is “uSD”.
Options are:
- “uSD”: uncorrelated Standard Deviation
- “uSE”: uncorrelated Standard Error
- “SD”: Standard Deviation
- “SE”: Standard Error</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.step" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.try_deletion">
<span class="sig-name descname"><span class="pre">try_deletion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.try_deletion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.try_deletion" title="Link to this definition"></a></dt>
<dd><p>Try to delete an adsorbate molecule from the framework.
This method randomly selects an adsorbate molecule and try to apply the deletion.</p>
<p>If there are no adsorbates, it returns False.</p>
<section id="id29">
<h3>Returns<a class="headerlink" href="#id29" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if the deletion was accepted, False otherwise.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.try_insertion">
<span class="sig-name descname"><span class="pre">try_insertion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.try_insertion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.try_insertion" title="Link to this definition"></a></dt>
<dd><p>Try to insert a new adsorbate molecule into the framework.
This method randomly places the adsorbate in the framework and checks for van der Waals overlap.
If there is no overlap, it calculates the new potential energy and decides whether to accept the insertion
based on the acceptance criteria.
If after a number of tries (self.max_overlap_tries) no valid position is found, the insertion is rejected.</p>
<section id="id30">
<h3>Returns<a class="headerlink" href="#id30" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if the insertion was accepted, False otherwise.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.try_rotation">
<span class="sig-name descname"><span class="pre">try_rotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.try_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.try_rotation" title="Link to this definition"></a></dt>
<dd><p>Try to rotate an adsorbate molecule within the framework.
This method randomly selects an adsorbate molecule and applies a random rotation.
It checks for van der Waals overlap and calculates the new potential energy.</p>
<section id="id31">
<h3>Returns<a class="headerlink" href="#id31" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if the rotation was accepted, False otherwise.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.gcmc.GCMC.try_translation">
<span class="sig-name descname"><span class="pre">try_translation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/flames/gcmc.html#GCMC.try_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.gcmc.GCMC.try_translation" title="Link to this definition"></a></dt>
<dd><p>Try to translate an adsorbate molecule within the framework.
This method randomly selects an adsorbate molecule and applies a random translation.
It checks for van der Waals overlap and calculates the new potential energy.</p>
<section id="id32">
<h3>Returns<a class="headerlink" href="#id32" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>bool</dt><dd><p>True if the translation was accepted, False otherwise.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames.logger">
<span id="flames-logger-module"></span><h2>flames.logger module<a class="headerlink" href="#module-flames.logger" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.logger.BaseLogger">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.logger.</span></span><span class="sig-name descname"><span class="pre">BaseLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#BaseLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.BaseLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Handles all logging and printing for the simulators.
Separates the presentation logic from the simulation logic.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.BaseLogger.print_debug_movement">
<span class="sig-name descname"><span class="pre">print_debug_movement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">movement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefactor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#BaseLogger.print_debug_movement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.BaseLogger.print_debug_movement" title="Link to this definition"></a></dt>
<dd><p>Print debug information about the current state of the simulation.
This method is called to provide detailed information about the current state of the system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.BaseLogger.print_header">
<span class="sig-name descname"><span class="pre">print_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#BaseLogger.print_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.BaseLogger.print_header" title="Link to this definition"></a></dt>
<dd><p>Prints the header for the simulation output.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.BaseLogger.print_restart_info">
<span class="sig-name descname"><span class="pre">print_restart_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#BaseLogger.print_restart_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.BaseLogger.print_restart_info" title="Link to this definition"></a></dt>
<dd><p>Prints information when a simulation is restarted.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.logger.</span></span><span class="sig-name descname"><span class="pre">GCMCLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#flames.logger.BaseLogger" title="flames.logger.BaseLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></p>
<p>Handles all logging and printing for a GCMC simulation.
Separates the presentation logic from the simulation logic.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_debug_movement">
<span class="sig-name descname"><span class="pre">print_debug_movement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">movement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltaE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefactor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_number</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_debug_movement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_debug_movement" title="Link to this definition"></a></dt>
<dd><p>Prints detailed debug information for a single MC move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_iteration_info">
<span class="sig-name descname"><span class="pre">print_iteration_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_iteration_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_iteration_info" title="Link to this definition"></a></dt>
<dd><p>Prints a single log line for a GCMC iteration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_load_state_info">
<span class="sig-name descname"><span class="pre">print_load_state_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_ads_energy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_load_state_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_load_state_info" title="Link to this definition"></a></dt>
<dd><p>Prints information about the loading state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_optimization_start">
<span class="sig-name descname"><span class="pre">print_optimization_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_optimization_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_optimization_start" title="Link to this definition"></a></dt>
<dd><p>Prints a header for framework or adsorbate optimization.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_run_header">
<span class="sig-name descname"><span class="pre">print_run_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_run_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_run_header" title="Link to this definition"></a></dt>
<dd><p>Prints the header for the main GCMC loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_step_info">
<span class="sig-name descname"><span class="pre">print_step_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_ads_energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_time</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_step_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_step_info" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.GCMCLogger.print_summary">
<span class="sig-name descname"><span class="pre">print_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/logger.html#GCMCLogger.print_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.GCMCLogger.print_summary" title="Link to this definition"></a></dt>
<dd><p>Prints the final summary of the simulation results.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flames.logger.WidomLogger">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.logger.</span></span><span class="sig-name descname"><span class="pre">WidomLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">TextIO</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#WidomLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.WidomLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#flames.logger.BaseLogger" title="flames.logger.BaseLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseLogger</span></code></a></p>
<p>Handles all logging and printing for a Widom insertion simulation.
Separates the presentation logic from the simulation logic.</p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.WidomLogger.print_iteration_info">
<span class="sig-name descname"><span class="pre">print_iteration_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#WidomLogger.print_iteration_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.WidomLogger.print_iteration_info" title="Link to this definition"></a></dt>
<dd><p>Prints a single log line for a Widom iteration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.WidomLogger.print_run_header">
<span class="sig-name descname"><span class="pre">print_run_header</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#WidomLogger.print_run_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.WidomLogger.print_run_header" title="Link to this definition"></a></dt>
<dd><p>Prints the header for the main Widom loop.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.logger.WidomLogger.print_summary">
<span class="sig-name descname"><span class="pre">print_summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/logger.html#WidomLogger.print_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.logger.WidomLogger.print_summary" title="Link to this definition"></a></dt>
<dd><p>Print the footer for the simulation output.
This method is called at the end of the simulation to display the final results and elapsed time.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames.operations">
<span id="flames-operations-module"></span><h2>flames.operations module<a class="headerlink" href="#module-flames.operations" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.check_overlap">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">check_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group1_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group2_indices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_radii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/flames/operations.html#check_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.check_overlap" title="Link to this definition"></a></dt>
<dd><p>Checks for van der Waals overlap between two specified groups of atoms.</p>
<p>This function is more efficient as it calculates a distance matrix between
the two groups in a single call rather than looping.</p>
<p>This function takes between 1 to 10 ms to evaluate the structure and has O(N) complexity.</p>
<section id="id33">
<h3>Parameters:<a class="headerlink" href="#id33" title="Link to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>atoms (ase.Atoms):</dt><dd><p>The ASE Atoms object containing the entire system.</p>
</dd>
<dt>group1_indices (array_like):</dt><dd><p>A list or array of indices for atoms in the first group.</p>
</dd>
<dt>group2_indices (array_like):</dt><dd><p>A list or array of indices for atoms in the second group.</p>
</dd>
<dt>vdw_radii (array_like):</dt><dd><p>A n array mapping atomic numbers to van der Waals radii.</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><dl class="simple">
<dt>has_overlap (bool):</dt><dd><p>True if any atom in group1 overlaps with an atom in group2, False otherwise.</p>
</dd>
</dl>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.random_mol_insertion">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">random_mol_insertion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Atoms</span></span></span><a class="reference internal" href="_modules/flames/operations.html#random_mol_insertion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.random_mol_insertion" title="Link to this definition"></a></dt>
<dd><p>Generates a random position within the unit cell defined by the lattice vectors.</p>
<section id="id34">
<h3>Parameters:<a class="headerlink" href="#id34" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>original_positions (np.ndarray):</dt><dd><p>The original positions of the atoms or molecules to be translated as a 3D vector.</p>
</dd>
<dt>lattice_vectors (np.ndarray):</dt><dd><p>A 3x3 matrix where each row is a lattice vector defining the unit cell.</p>
</dd>
<dt>rnd_generator (np.random.Generator):</dt><dd><p>A random number generator instance for reproducibility.</p>
</dd>
</dl>
</section>
<section id="id35">
<h3>Returns:<a class="headerlink" href="#id35" title="Link to this heading"></a></h3>
<blockquote>
<div><p>np.ndarray: A 3D random position inside the unit cell</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.random_position_cell">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">random_position_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_vectors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/operations.html#random_position_cell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.random_position_cell" title="Link to this definition"></a></dt>
<dd><p>Generates a random translation vector within the parallelepiped
defined by the lattice vectors, using a random generator for reproducibility.</p>
<section id="id36">
<h3>Parameters:<a class="headerlink" href="#id36" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>original_position (np.ndarray):</dt><dd><p>The original position of the atom or molecule to be translated as a 3D vector.</p>
</dd>
<dt>lattice_vectors (np.ndarray):</dt><dd><p>A 3x3 matrix where each row is a lattice vector defining the unit cell.</p>
</dd>
<dt>rnd_generator (np.random.Generator):</dt><dd><p>A random number generator instance for reproducibility.</p>
</dd>
</dl>
</section>
<section id="id37">
<h3>Returns:<a class="headerlink" href="#id37" title="Link to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray:</dt><dd><p>A 3D random position inside the unit cell.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.random_rotation">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">random_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/operations.html#random_rotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.random_rotation" title="Link to this definition"></a></dt>
<dd><p>Generates a random rotation of the original position vector around its geometrical center
using a provided generator.</p>
<section id="id38">
<h3>Parameters<a class="headerlink" href="#id38" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>original_position (np.ndarray):</dt><dd><p>The original position of the atom or molecule to be rotated as a 3D vector.
Can be a single point (shape <cite>(3,)</cite>) or multiple points (shape <cite>(N, 3)</cite>).</p>
</dd>
<dt>cell (np.ndarray):</dt><dd><p>Unit cell used to unwrap the atomic positions and perform the rotation correctly</p>
</dd>
<dt>rnd_generator (np.random.Generator):</dt><dd><p>A random number generator instance for reproducibility.</p>
</dd>
</dl>
</section>
<section id="id39">
<h3>Returns<a class="headerlink" href="#id39" title="Link to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray:</dt><dd><p>A 3D vector or array of vectors representing the rotated position(s).</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.random_rotation_limited">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">random_rotation_limited</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/operations.html#random_rotation_limited"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.random_rotation_limited" title="Link to this definition"></a></dt>
<dd><p>Generates a random rotation of the molecule around a random axis,
with rotation angle limited between -theta_max and theta_max (in radians).</p>
<section id="id40">
<h3>Parameters<a class="headerlink" href="#id40" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>original_position<span class="classifier">np.ndarray</span></dt><dd><p>Coordinates of shape (N, 3) or (3,) representing atoms in space.</p>
</dd>
<dt>cell (np.ndarray):</dt><dd><p>Unit cell used to unwrap the atomic positions and perform the rotation correctly</p>
</dd>
<dt>rnd_generator<span class="classifier">np.random.Generator</span></dt><dd><p>Random number generator for reproducibility.</p>
</dd>
<dt>theta_max<span class="classifier">float</span></dt><dd><p>Maximum rotation angle (in radians).</p>
</dd>
</dl>
</section>
<section id="id41">
<h3>Returns<a class="headerlink" href="#id41" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>Rotated coordinates with the same shape as input.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.random_translation">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">random_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">original_position</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_translation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/operations.html#random_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.random_translation" title="Link to this definition"></a></dt>
<dd><p>Generates a random translation vector for the original positions on the interval
[-max_translation/2, max_translation/2] using a provided generator.</p>
<section id="id42">
<h3>Parameters<a class="headerlink" href="#id42" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>original_position (np.ndarray):</dt><dd><p>The original positions of the atoms or molecules to be translated as a 3D vector.
Can be a single point (shape <cite>(3,)</cite>) or multiple points (shape <cite>(N, 3)</cite>).</p>
</dd>
<dt>cell (np.ndarray):</dt><dd><p>Unit cell used to unwrap the atomic positions and perform the rotation correctly</p>
</dd>
<dt>max_shift (float):</dt><dd><p>The maximum shift for the translation.</p>
</dd>
<dt>rnd_generator (np.random.Generator):</dt><dd><p>A random number generator instance for reproducibility.</p>
</dd>
</dl>
</section>
<section id="id43">
<h3>Returns<a class="headerlink" href="#id43" title="Link to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>np.ndarray:</dt><dd><p>A 3D vector or array of vectors representing the translated position(s).</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.operations.randon_unit_vector_sphere_marsaglia">
<span class="sig-prename descclassname"><span class="pre">flames.operations.</span></span><span class="sig-name descname"><span class="pre">randon_unit_vector_sphere_marsaglia</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rnd_generator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Generator</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/operations.html#randon_unit_vector_sphere_marsaglia"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.operations.randon_unit_vector_sphere_marsaglia" title="Link to this definition"></a></dt>
<dd><p>Generates a random uniform vector in the surface of a sphere with radius 1.</p>
<p>This function implements the method proposed by George Marsaglia in
The Annals of Mathematical Statistics, 1972, Vol. 43, No. 2, 645-646</p>
<p>This is the fastest implementation compared with other approaches,
such as Gaussian distributions or trigonometric functions.
This is also faster than simple genaration a vector on a cube.</p>
<p>Timing the generation of 1 vector, repeated 1,000,000 times.</p>
<p>Marsaglia: 4.4012 microseconds
Gaussian:  6.0038 microseconds
Trig:      10.8591 microseconds
Cube:      7.9170 microseconds</p>
<section id="id44">
<h3>Parameters<a class="headerlink" href="#id44" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>rnd_generator<span class="classifier">np.random.Generator</span></dt><dd><p>Random number generator for reproducibility.</p>
</dd>
</dl>
</section>
<section id="id45">
<h3>Returns<a class="headerlink" href="#id45" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>np.ndarray</dt><dd><p>Random vector in cartesian coordinates</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-flames.utilities">
<span id="flames-utilities-module"></span><h2>flames.utilities module<a class="headerlink" href="#module-flames.utilities" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.calculate_unit_cells">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">calculate_unit_cells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12.6</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/utilities.html#calculate_unit_cells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.calculate_unit_cells" title="Link to this definition"></a></dt>
<dd><p>Calculate the number of unit cell repetitions so that all supercell lengths are larger than
twice the interaction potential cut-off radius.</p>
<p>RASPA considers the perpendicular directions the directions perpendicular to the <cite>ab</cite>, <cite>bc</cite>,
and <cite>ca</cite> planes. Thus, the directions depend on who the crystallographic vectors <cite>a</cite>, <cite>b</cite>,
and <cite>c</cite> are and the length in the perpendicular directions would be the projections
of the crystallographic vectors on the vectors <cite>a x b</cite>, <cite>b x c</cite>, and <cite>c x a</cite>.
(here <cite>x</cite> means cross product)</p>
<section id="id46">
<h3>Parameters<a class="headerlink" href="#id46" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cell<span class="classifier">ase.Cell</span></dt><dd><p>The unit cell for which to calculate the perpendicular lengths.</p>
</dd>
<dt>cutoff<span class="classifier">float</span></dt><dd><p>The interaction potential cut-off radius.</p>
</dd>
</dl>
</section>
<section id="id47">
<h3>Returns<a class="headerlink" href="#id47" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>supercell<span class="classifier">list[int]</span></dt><dd><p>(3,1) list containg the number of repeating units in <cite>x</cite>, <cite>y</cite>, <cite>z</cite> directions.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.check_weights">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">check_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">move_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/flames/utilities.html#check_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.check_weights" title="Link to this definition"></a></dt>
<dd><p>Check if the move weights are valid and normalize them to sum to 1.</p>
<p>Parameters:
- move_weights (dict): A dictionary containing the move weights for ‘insertion’, ‘deletion’, ‘translation’, and ‘rotation’.
Returns:
- dict: Normalized move weights.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.enthalpy_of_adsorption">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">enthalpy_of_adsorption</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">energy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_molecules</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/utilities.html#enthalpy_of_adsorption"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.enthalpy_of_adsorption" title="Link to this definition"></a></dt>
<dd><p>Calculates the enthalpy of adsorption as</p>
<p>H = &lt;EN&gt; - &lt;E&gt;&lt;N&gt; / &lt;N^2&gt; - &lt;N&gt;^2 - RT</p>
<p>adapted from J. Phys. Chem. 1993, 97, 51, 13742-13752.</p>
<p>Please note that Heat of adsorption (Q_iso) = -Enthalpy of adsorption (H).</p>
<p>The isosteric enthalpy of adsorption, H, is defined as the heat which is released
when an adsorptive binds to a surface. The enthalpy of adsorption (H) is a negative
number and the isosteric heat (Q_iso) of adsorption is a positive number.
For a deeper discussion see: Dalton Trans., 2020, 49, 10295.</p>
<section id="id48">
<h3>Parameters<a class="headerlink" href="#id48" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>energy<span class="classifier">1D array</span></dt><dd><p>List with the potential energy of the adsorbed phase for each MC cycle in units of Kelvin.</p>
</dd>
<dt>number_of_molecules<span class="classifier">1D array</span></dt><dd><p>List with the number of molecules in the simulation system for each MC cycle.</p>
</dd>
<dt>temperature<span class="classifier">float</span></dt><dd><p>Temperature of the simulation in Kelvin</p>
</dd>
</dl>
</section>
<section id="id49">
<h3>Returns<a class="headerlink" href="#id49" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>H<span class="classifier">float</span></dt><dd><p>Enthalpy of adsorption in units of kJ⋅mol-1</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.get_density">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">get_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/flames/utilities.html#get_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.get_density" title="Link to this definition"></a></dt>
<dd><p>Get the density of the framework in g/cm^3</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.get_perpendicular_lengths">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">get_perpendicular_lengths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Cell</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/utilities.html#get_perpendicular_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.get_perpendicular_lengths" title="Link to this definition"></a></dt>
<dd><p>Calculate the perpendicular lengths of a unit cell.</p>
<section id="id50">
<h3>Parameters<a class="headerlink" href="#id50" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cell<span class="classifier">ase.Cell</span></dt><dd><p>The unit cell for which to calculate the perpendicular lengths.</p>
</dd>
</dl>
</section>
<section id="id51">
<h3>Returns<a class="headerlink" href="#id51" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>tuple[float, float, float]</dt><dd><p>The perpendicular lengths in the x, y, and z directions.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.make_cubic">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">make_cubic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_diagonal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_90_degrees</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Atoms</span></span></span><a class="reference internal" href="_modules/flames/utilities.html#make_cubic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.make_cubic" title="Link to this definition"></a></dt>
<dd><p>Transform the primitive structure into a supercell with alpha, beta, and
gamma equal, or close, to 90 degrees. The algorithm will iteratively increase the size
of the supercell until the largest inscribed cube’s side length is at least ‘min_length’
and the number of atoms in the supercell falls in the range <code class="docutils literal notranslate"><span class="pre">min_atoms</span> <span class="pre">&lt;</span> <span class="pre">n</span> <span class="pre">&lt;</span> <span class="pre">max_atoms</span></code>.</p>
<section id="id52">
<h3>Parameters<a class="headerlink" href="#id52" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>min_length<span class="classifier">float, optional</span></dt><dd><p>Minimum length of the cubic cell (default is 10)</p>
</dd>
<dt>force_diagonal<span class="classifier">bool, optional</span></dt><dd><p>If True, generate a transformation with a diagonal transformation matrix (default is False)</p>
</dd>
<dt>force_90_degrees<span class="classifier">bool, optional</span></dt><dd><p>If True, force the angles to be 90 degrees (default is False)</p>
</dd>
<dt>min_atoms<span class="classifier">int, optional</span></dt><dd><p>Minimum number of atoms in the supercell (default is 0)</p>
</dd>
<dt>max_atoms<span class="classifier">int, optional</span></dt><dd><p>Maximum number of atoms in the supercell (default is 10000)</p>
</dd>
<dt>angle_tolerance<span class="classifier">float, optional</span></dt><dd><p>The angle tolerance for the transformation (default is 1e-3)</p>
</dd>
</dl>
<p>Returns</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.random_n_splits">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">random_n_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_generator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/flames/utilities.html#random_n_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.random_n_splits" title="Link to this definition"></a></dt>
<dd><p>Generate n arrays where each array has exactly (100/n)% of the data removed randomly.
The removed data is unique per array (no overlap between removed subsets).</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>data (np.ndarray): Input array
n (int): Number of arrays to generate
random_generator: Optional random generator for reproducibility</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: List of n arrays with equal-sized unique removals</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="flames.utilities.read_cif">
<span class="sig-prename descclassname"><span class="pre">flames.utilities.</span></span><span class="sig-name descname"><span class="pre">read_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/utilities.html#read_cif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.utilities.read_cif" title="Link to this definition"></a></dt>
<dd><p>Reads a file in format <cite>.cif</cite> from the <cite>path</cite> given and returns
a list containg the N atom labels and a Nx3 array contaning
the atoms coordinates.</p>
<section id="id53">
<h3>Parameters<a class="headerlink" href="#id53" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file_name<span class="classifier">str</span></dt><dd><p>Name of the <cite>cif</cite> file. Does not neet to contain the <cite>.cif</cite> extention.</p>
</dd>
</dl>
</section>
<section id="id54">
<h3>Returns<a class="headerlink" href="#id54" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>cell<span class="classifier">numpy array</span></dt><dd><p>3x3 array contaning the cell vectors.</p>
</dd>
<dt>atom_labels<span class="classifier">list</span></dt><dd><p>List of strings containing containg the N atom labels.</p>
</dd>
<dt>atom_pos<span class="classifier">numpy array</span></dt><dd><p>Nx3 array contaning the atoms coordinates</p>
</dd>
<dt>charges<span class="classifier">list</span></dt><dd><p>List of strings containing containg the N atom partial charges.</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
<section id="module-flames.version">
<span id="flames-version-module"></span><h2>flames.version module<a class="headerlink" href="#module-flames.version" title="Link to this heading"></a></h2>
</section>
<section id="module-flames.widom">
<span id="flames-widom-module"></span><h2>flames.widom module<a class="headerlink" href="#module-flames.widom" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="flames.widom.Widom">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">flames.widom.</span></span><span class="sig-name descname"><span class="pre">Widom</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">framework_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adsorbate_atoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_radii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vdw_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_overlap_tries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_deltaE</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.555</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_rejected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_to_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">debug</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_radius</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">automatic_supercell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flames/widom.html#Widom"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#flames.base_simulator.BaseSimulator" title="flames.base_simulator.BaseSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSimulator</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.restart">
<span class="sig-name descname"><span class="pre">restart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.restart"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.restart" title="Link to this definition"></a></dt>
<dd><p>Restart the simulation from the last state.</p>
<p>This method loads the last saved state from the trajectory file and restores the simulation to that state.
It also loads the uptake, total energy, and total adsorbates lists from the saved files if they exist.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.run" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.save_results">
<span class="sig-name descname"><span class="pre">save_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Widom_Results.json'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.save_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.save_results" title="Link to this definition"></a></dt>
<dd><p>Save a json file with the main results of the simulation.</p>
<section id="id55">
<h3>Parameters<a class="headerlink" href="#id55" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>file_name<span class="classifier">str, optional</span></dt><dd><p>Name of the output json file (default is ‘Widom_Results.json’).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.step" title="Link to this definition"></a></dt>
<dd><p>Run a single iteration of the Widom insertion method.</p>
<section id="id56">
<h3>Parameters<a class="headerlink" href="#id56" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>iteration<span class="classifier">int</span></dt><dd><p>The current iteration number.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.try_insertion">
<span class="sig-name descname"><span class="pre">try_insertion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Atoms</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.try_insertion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.try_insertion" title="Link to this definition"></a></dt>
<dd><p>Try to insert a new adsorbate molecule into the framework.
This method randomly places the adsorbate in the framework and checks for van der Waals overlap.
If there is no overlap, it calculates the new potential energy and decides whether to accept the insertion
based on the acceptance criteria.</p>
<section id="id57">
<h3>Returns<a class="headerlink" href="#id57" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>deltaE<span class="classifier">float</span></dt><dd><p>The change in energy associated with the insertion. If the insertion fails, returns a large value (1000.0).</p>
</dd>
<dt>atoms_trial<span class="classifier">ase.Atoms</span></dt><dd><p>The trial configuration after the insertion attempt.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flames.widom.Widom.update_statistics">
<span class="sig-name descname"><span class="pre">update_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deltaE</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/flames/widom.html#Widom.update_statistics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flames.widom.Widom.update_statistics" title="Link to this definition"></a></dt>
<dd><p>Update the statistics of the Widom insertion method after a new insertion.</p>
<section id="id58">
<h3>Parameters<a class="headerlink" href="#id58" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>deltaE<span class="classifier">float</span></dt><dd><p>The change in energy associated with the latest insertion.</p>
</dd>
</dl>
</section>
</dd></dl>

</dd></dl>

</section>
<section id="module-flames">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-flames" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Felipe Lopes.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>